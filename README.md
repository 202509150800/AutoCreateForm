# 批量表格生成工具

一個簡單易用的 Web 應用，可根據 Excel 資料自動填寫 Word 範本，並批量生成 Word 和 PDF 檔案。

## 功能特性

✨ **主要功能：**
- 🔧 在介面中定義欄位名稱
- 📁 上傳 Excel 資料檔案
- 📄 上傳 Word 表格範本
- 🚀 根據 Excel 資料自動填寫 Word 表格
- 📑 批量生成 PDF 檔案
- 📦 打包所有生成的檔案為 ZIP

✅ **特點：**
- 直觀的圖形使用者介面 (GUI)
- 支援拖拽上傳檔案
- 在介面中直接定義欄位，無需下載範本
- 即時預覽 Excel 資料
- 根據 Excel 中的 ID 欄位自動命名檔案
- 一鍵下載所有生成檔案

## 系統需求

- **Node.js** 14.0 或更高版本
- **npm** 6.0 或更高版本
- **LibreOffice** (用於 PDF 轉換，可選)

## 安裝步驟

```bash
# 1. 安裝依賴
npm install

# 2. 啟動應用
npm start
```

應用將在 `http://localhost:3000` 啟動

## 使用方法

### 步驟 1：定義欄位
1. 在介面中輸入您需要的欄位名稱
2. 點擊「➕ 添加欄位」按鈕
3. ID 欄位是必須的（用於檔案命名）

### 步驟 2：準備並上傳 Excel 資料
1. 用 Excel 建立您的資料檔案
2. **第一行是欄位名稱**，與您定義的欄位相同
3. 從第二行開始填寫資料
4. 儲存為 `.xlsx` 格式並上傳

**Excel 格式範例：**
```
ID  | 姓名 | 電話      | 地址
----|------|-----------|-------------
1   | 張三 | 0912345678| 台北市
2   | 李四 | 0987654321| 台中市
```

### 步驟 3：上傳 Word 範本
1. 準備 `.docx` 格式的 Word 範本
2. 使用 `{欄位名稱}` 格式標記要填寫的位置

**Word 範本範例：**
```
姓名：{姓名}
電話：{電話}
地址：{地址}
```

### 步驟 4：生成檔案
1. 勾選要生成的檔案類型（Word / PDF）
2. 點擊「開始生成」
3. 下載 ZIP 檔案

## 佔位符語法

```
{欄位名稱}

範例：
- {姓名} → 會被替換為 Excel 中「姓名」欄位的值
- {電話} → 會被替換為 Excel 中「電話」欄位的值
```

**注意：** 佔位符名稱必須與 Excel 欄位名稱完全相同

## 故障排除

| 問題 | 解決方案 |
|------|----------|
| PDF 生成失敗 | 安裝 LibreOffice：https://www.libreoffice.org/download/ |
| 佔位符未被替換 | 確保使用 `{欄位}` 格式，名稱與 Excel 完全相同 |
| Excel 上傳失敗 | 確保包含 ID 欄位，格式為 .xlsx |

## 版本歷史

### v2.0.0 (2025-11-30)
- 移除下載範本功能，改為在介面中直接定義欄位
- 佔位符格式從 `{{欄位}}` 改為 `{欄位}`
- 新增 Excel 資料即時預覽功能

## 技術棧

- **前端：** HTML5, CSS3, JavaScript
- **後端：** Node.js, Express.js
- **資料處理：** XLSX, JSZip
- **PDF 轉換：** LibreOffice

## 許可證

ISC License
